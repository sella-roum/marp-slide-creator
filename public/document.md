## AI-Assisted Marp Slide Creator 操作説明

このアプリケーションをご利用いただきありがとうございます。ここでは、AIの支援を受けながらMarp形式のプレゼンテーションスライドを作成する方法を説明します。

**1. はじめに**

このツールは、Markdownという簡単な記法を使ってプレゼンテーションスライドを作成できる「Marp」の作成をサポートします。AI（Google Gemini）がコンテンツ作成やテーマデザインをお手伝いします。作成したデータは、お使いのブラウザに自動で保存されます。

**2. 画面構成**

アプリケーションの画面は、主に以下のエリアで構成されています。

*   **ヘッダー:** 画面上部にあり、ドキュメントのタイトル表示、レイアウト変更、パネル表示切替、エクスポート、テーマ（ライト/ダーク）切り替えなどの操作ボタンがあります。
*   **チャットパネル:** AIとの対話を行うエリアです。AIへの指示や質問を入力し、応答を受け取ります。AIが生成したコードをエディタやカスタムCSSに適用することもできます。（デフォルトでは左側、レイアウトにより位置変更可能）
*   **エディタパネル:** スライドの内容をMarkdown形式で記述するエリアです。書式設定用のツールバーも備わっています。（デフォルトでは中央）
*   **プレビューパネル:** エディタで記述したMarkdownが、Marpスライドとしてどのように表示されるかをリアルタイムで確認できるエリアです。（デフォルトでは右側）

**3. 基本的なスライド作成**

1.  **エディタパネル**にMarkdown形式でスライドの内容を入力します。
    *   見出しは `#`、リストは `-` や `*` を使います。
    *   新しいスライドを始めるには、行頭に `---` と入力します。
2.  **プレビューパネル**で、入力内容がリアルタイムでスライドとして表示されるのを確認します。
3.  スライドの基本的な設定（Marpを使う宣言やテーマ指定など）は、エディタの先頭に `---` で囲んで記述します（Front Matter）。
    ```markdown
    ---
    marp: true
    theme: default
    ---

    # ここからスライド内容
    ```
    *   `marp: true` はMarpを使うための必須の記述です。
    *   `theme:` でスライドの見た目を変更できます（後述）。
    *   ツールバーの「Marp」ボタンで基本的なFront Matterを挿入できます。

**4. AIチャット機能の利用**

**チャットパネル**を使ってAIに様々な作業を依頼できます。

1.  **依頼タイプの選択:** チャット入力欄の上にあるアイコンボタンで、AIへの依頼内容を選択します。
    *   📄 **スライド作成:** プレゼンのアウトライン作成、特定のスライド内容生成などを依頼します。（例: 「自己紹介スライドを作って」）
    *   🎨 **テーマCSS生成:** スライドの見た目を変えるCSSコードの生成を依頼します。（例: 「青を基調としたクールなテーマのCSSを作って」）
    *   💬 **相談・質問:** Marpの使い方やプレゼンに関する一般的な質問・相談をします。（例: 「Marpで画像を中央揃えにする方法は？」）
2.  **メッセージ送信:** 入力欄に具体的な指示や質問を入力し、「送信」ボタン（紙飛行機アイコン）を押すか、`Enter`キー（Shift+Enterで改行）を押します。
3.  **応答の確認:** AIからの応答がチャット履歴に表示されます。
4.  **コードの適用:**
    *   AIがMarkdownコード（スライド内容）を生成した場合、「Markdownコピー」ボタンでコードをコピーしたり、「エディタに適用」ボタンで直接エディタに内容を反映させたりできます。
    *   AIがCSSコード（テーマ）を生成した場合、「CSSコピー」ボタンでコードをコピーしたり、「CSSに適用」ボタンでカスタムCSSとして適用したりできます（テーマ設定は自動的に「Custom CSS」に切り替わります）。
5.  **履歴クリア:** チャットヘッダーの「履歴クリア」ボタンで、現在のドキュメントに関するチャット履歴を削除できます。

**5. エディタツールバーの利用**

**エディタパネル**の上部にあるツールバーで、Markdownの入力を補助します。

*   **書式設定:** 見出し(H1, H2)、太字(B)、斜体(I)、リンク、コードブロック(` ``` `)、リスト、引用(>)などのボタンで、対応するMarkdown記法をカーソル位置に挿入したり、選択範囲に適用したりできます。
*   **要素挿入:** スライド区切り(`---`)や基本的なMarpディレクティブ（Front Matter）を挿入するボタンがあります。
*   **画像URL挿入:** リンクアイコンのボタンで、Web上の画像のURLを入力してMarkdownに挿入できます。
*   **元に戻す/やり直し:** Undo (左向き矢印) / Redo (右向き矢印) ボタンで、エディタでの操作を取り消したり、やり直したりできます。キーボードショートカット (`Ctrl+Z` / `Cmd+Z` で元に戻す、`Ctrl+Y` / `Cmd+Shift+Z` でやり直す) も利用可能です。

**6. テーマの選択とカスタマイズ**

スライドの見た目を変更できます。

1.  **内蔵テーマの選択:** エディタツールバーのテーマ名が表示されているボタン（例: `Default`）をクリックし、ドロップダウンメニューから `Default`, `Gaia`, `Uncover` のいずれかを選択します。選択すると、プレビューが更新され、エディタ内の `theme:` ディレクティブも自動的に書き換わります。
2.  **カスタムCSSの編集:**
    *   エディタツールバーのコードアイコン（ファイルに<>）のボタンをクリックすると、「カスタムCSS編集」ダイアログが開きます。
    *   テキストエリアに独自のCSSルールを入力します。
    *   「保存して適用」ボタンを押すと、入力したCSSがスライドに適用され、テーマ設定は自動的に「Custom CSS」に切り替わります。
3.  **AIによるテーマ生成:** チャットパネルで「テーマCSS生成」を選択し、「緑系の落ち着いたテーマ」のように指示すると、AIがCSSコードを生成します。生成されたCSSは「CSSに適用」ボタンでカスタムCSSとして適用できます。

**7. 画像ライブラリの利用**

スライドで使用する画像を管理し、簡単に挿入できます。

1.  **ライブラリを開く:** エディタツールバーの画像アイコン（山と太陽）のボタンをクリックすると、「画像ライブラリ」ダイアログが開きます。
2.  **アップロード:** ダイアログ内の「新しい画像をアップロード」ボタンをクリックし、ローカルの画像ファイルを選択すると、画像がライブラリに追加され、ブラウザに保存されます。
3.  **画像の確認:** アップロードされた画像がグリッド表示されます。
4.  **参照の挿入:** 各画像カードの「挿入」ボタンをクリックすると、`![画像名](image://画像ID)` という形式の参照文字列がエディタのカーソル位置に挿入され、ダイアログが閉じます。プレビューパネルでは、この参照が実際の画像に置き換わって表示されます。
5.  **参照のコピー:** 各画像カードの「参照コピー」ボタンで、上記の参照文字列をクリップボードにコピーできます。
6.  **削除:** 各画像カードのゴミ箱アイコンのボタンで、ライブラリから画像を削除できます（確認ダイアログが表示されます）。

**8. レイアウトの変更**

作業しやすいように画面レイアウトを変更できます。

1.  **レイアウトモード変更:** ヘッダーの「Layout」ボタンをクリックし、ドロップダウンメニューから好みのレイアウト（横3列、チャット左/右配置、エディタ上/下配置など）を選択します。
2.  **パネル表示切替:** ヘッダーにあるチャット（吹き出し）、エディタ（コード）、プレビュー（目）の各アイコンボタンをクリックすることで、対応するパネルの表示/非表示を切り替えられます。（最低1つのパネルは常に表示されます）

**9. エクスポート機能**

作成したスライドをファイルとして保存できます。

1.  ヘッダーの「Export」ボタンをクリックします。
2.  ドロップダウンメニューからエクスポート形式を選択します。
    *   **HTMLとしてエクスポート:** スライド送りやフルスクリーン表示が可能な、単体のHTMLファイル（`.html`）としてダウンロードします。カスタムCSSも埋め込まれます。
    *   **Markdownとしてエクスポート:** 現在のエディタの内容をMarkdownファイル（`.md`）としてダウンロードします。画像ライブラリの画像はBase64形式で埋め込まれます。
3.  ダイアログが表示されるので、「〇〇としてエクスポート」ボタンをクリックするとダウンロードが開始されます。

**10. データ保存について**

*   このアプリケーションで作成したドキュメント（Markdown、タイトル、テーマ設定、カスタムCSS）、チャット履歴、アップロードした画像は、お使いの**ブラウザのローカルストレージ (IndexedDB) に自動的に保存**されます。特別な保存操作は必要ありません。
*   **注意:** ブラウザの閲覧履歴やキャッシュ、サイトデータを消去すると、このアプリケーションで保存したデータも**すべて消えてしまう**可能性があります。重要なデータは、定期的にMarkdownやHTML形式でエクスポートしてバックアップを取ることをお勧めします。

**11. その他**

*   **テーマ切り替え:** ヘッダー右端の太陽/月アイコンのボタンで、アプリケーション全体の表示をライトモード/ダークモード/システム設定に切り替えられます。

これで基本的な操作は完了です。AIの力を借りて、効率的なスライド作成をお楽しみください！``` `)、リスト、引用(>)などのボタンで、対応するMarkdown記法をカーソル位置に挿入したり、選択範囲に適用したりできます。
*   **要素挿入:** スライド区切り(`---`)や基本的なMarpディレクティブ（Front Matter）を挿入するボタンがあります。
*   **画像URL挿入:** リンクアイコンのボタンで、Web上の画像のURLを入力してMarkdownに挿入できます。
*   **元に戻す/やり直し:** Undo (左向き矢印) / Redo (右向き矢印) ボタンで、エディタでの操作を取り消したり、やり直したりできます。キーボードショートカット (`Ctrl+Z` / `Cmd+Z` で元に戻す、`Ctrl+Y` / `Cmd+Shift+Z` でやり直す) も利用可能です。

**6. テーマの選択とカスタマイズ**

スライドの見た目を変更できます。

1.  **内蔵テーマの選択:** エディタツールバーのテーマ名が表示されているボタン（例: `Default`）をクリックし、ドロップダウンメニューから `Default`, `Gaia`, `Uncover` のいずれかを選択します。選択すると、プレビューが更新され、エディタ内の `theme:` ディレクティブも自動的に書き換わります。
2.  **カスタムCSSの編集:**
    *   エディタツールバーのコードアイコン（ファイルに<>）のボタンをクリックすると、「カスタムCSS編集」ダイアログが開きます。
    *   テキストエリアに独自のCSSルールを入力します。
    *   「保存して適用」ボタンを押すと、入力したCSSがスライドに適用され、テーマ設定は自動的に「Custom CSS」に切り替わります。
3.  **AIによるテーマ生成:** チャットパネルで「テーマCSS生成」を選択し、「緑系の落ち着いたテーマ」のように指示すると、AIがCSSコードを生成します。生成されたCSSは「CSSに適用」ボタンでカスタムCSSとして適用できます。

**7. 画像ライブラリの利用**

スライドで使用する画像を管理し、簡単に挿入できます。

1.  **ライブラリを開く:** エディタツールバーの画像アイコン（山と太陽）のボタンをクリックすると、「画像ライブラリ」ダイアログが開きます。
2.  **アップロード:** ダイアログ内の「新しい画像をアップロード」ボタンをクリックし、ローカルの画像ファイルを選択すると、画像がライブラリに追加され、ブラウザに保存されます。
3.  **画像の確認:** アップロードされた画像がグリッド表示されます。
4.  **参照の挿入:** 各画像カードの「挿入」ボタンをクリックすると、`![画像名](image://画像ID)` という形式の参照文字列がエディタのカーソル位置に挿入され、ダイアログが閉じます。プレビューパネルでは、この参照が実際の画像に置き換わって表示されます。
5.  **参照のコピー:** 各画像カードの「参照コピー」ボタンで、上記の参照文字列をクリップボードにコピーできます。
6.  **削除:** 各画像カードのゴミ箱アイコンのボタンで、ライブラリから画像を削除できます（確認ダイアログが表示されます）。

**8. レイアウトの変更**

作業しやすいように画面レイアウトを変更できます。

1.  **レイアウトモード変更:** ヘッダーの「Layout」ボタンをクリックし、ドロップダウンメニューから好みのレイアウト（横3列、チャット左/右配置、エディタ上/下配置など）を選択します。
2.  **パネル表示切替:** ヘッダーにあるチャット（吹き出し）、エディタ（コード）、プレビュー（目）の各アイコンボタンをクリックすることで、対応するパネルの表示/非表示を切り替えられます。（最低1つのパネルは常に表示されます）

**9. エクスポート機能**

作成したスライドをファイルとして保存できます。

1.  ヘッダーの「Export」ボタンをクリックします。
2.  ドロップダウンメニューからエクスポート形式を選択します。
    *   **HTMLとしてエクスポート:** スライド送りやフルスクリーン表示が可能な、単体のHTMLファイル（`.html`）としてダウンロードします。カスタムCSSも埋め込まれます。
    *   **Markdownとしてエクスポート:** 現在のエディタの内容をMarkdownファイル（`.md`）としてダウンロードします。画像ライブラリの画像はBase64形式で埋め込まれます。
3.  ダイアログが表示されるので、「〇〇としてエクスポート」ボタンをクリックするとダウンロードが開始されます。

**10. データ保存について**

*   このアプリケーションで作成したドキュメント（Markdown、タイトル、テーマ設定、カスタムCSS）、チャット履歴、アップロードした画像は、お使いの**ブラウザのローカルストレージ (IndexedDB) に自動的に保存**されます。特別な保存操作は必要ありません。
*   **注意:** ブラウザの閲覧履歴やキャッシュ、サイトデータを消去すると、このアプリケーションで保存したデータも**すべて消えてしまう**可能性があります。重要なデータは、定期的にMarkdownやHTML形式でエクスポートしてバックアップを取ることをお勧めします。

**11. その他**

*   **テーマ切り替え:** ヘッダー右端の太陽/月アイコンのボタンで、アプリケーション全体の表示をライトモード/ダークモード/システム設定に切り替えられます。

これで基本的な操作は完了です。AIの力を借りて、効率的なスライド作成をお楽しみください！
